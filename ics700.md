<img class="float-right" src="images/j2c-logo.png" width="200">
# Lab 700: API Management Lab, Add Online Shopping API to APIPCS 
## Introduction

In this Lab we are going to use APIPCS to add an API for Online Shopping REST API and secure the API using Policies.


About APIPCS:

The Oracle API Platform Cloud Service is a great API Management solution which supports agile API development, and also makes it easy to keep an eye on KPIs covering every aspect of the API lifecycle. True hybrid API deployment – in the Cloud or on-premises – means that your API solution is modern and adaptable, all while employing the most up-to-date security protocols.

### Login to APIPCS Home Page
NOTE: the User Name and Password values will be given to you by your instructor. See Lab 100 1.1.1: Login to your Oracle Cloud Account for more information on how to sign into the APIPCS home page.

![](images/700/img01.png)

Sign in to the Management Portal as a user with the API Manager role:

Sign in to the Management Portal as a user with the API Manager role:

![](images/700/img02.png)

### Creating an API Proxy

Now you’ll create a proxy for your API. To create an API:

From the APIs tab, click Create API.

![](images/700/img02.png)

 Enter the unique name of your resource  into the API Name field. 

 Enter 1 in the Version field.

(Optional) Populate the description field in this form as you would like.

![](images/700/img03.png)

Click Create.

![](images/700/img04.png)

### Configure the API Request

The API request is the endpoint to which requests for your API are sent when it is deployed to a gateway.

To configure the API Request:

 From the APIs page, click the API you created in the previous task.

 From left menu item click **Specification** tab as shown 

 ![](images/700/img05.png)

 Hover over the API Request policy, and then click Edit.

 ![](images/700/img06.png)

On the Apply Policy Dialog, complete these fields:

Select HTTPS from the Protocol list. This is the protocol on which the gateway receives requests for this API.

Enter name of your resource in lower case,  into the API Endpoint URL field.

![](images/700/img07.png)

Click Apply.

### Configure the Service Request

The service request is the URL at which your backend service receives requests. When a request meets all policy conditions, the gateway routes the request to this URL and calls your service.

The service request URL can point to any of your service’s resources, not just its base URL. This way you can restrict users to access only a subset of your API’s resources.

To configure the service request:

Hover over the Service Request policy, and then click Edit.

![](images/700/img08.png)

On the Apply Policy Dialog, complete these fields:

Paste the mock server value you copied at the end of Lab 300 (which should resemble https://ICS URL/integration/flowapi/ic/api/integration/v1/flows/rest/ONLINE_SHOPPING_APP/1.0/orders) into the Backend Service URL field.

Add the Service Account which stores the credentials to log into Oracle OICS

![](images/700/img11.png)

Click Apply.

![](images/700/img12.png)

Click Save Changes

### Deploy API to the API Gateway

After creating the API, adding the API Request and Service Request. In this section you will deploy the API to an API Gateway so that it receives requests at the endpoint you configured and routes successful requests to the service you created with Oracle OICS in Lab 300.

To perform the same from main menu click on deployments tab 

![](images/700/img13.png)

A new page comes up .From here click **Deploy API**

![](images/700/img14.png)

Here you will see a list of Deployment Gateways available with APIPCS.Select one of them and click **Deploy**

![](images/700/img15.png)

Wait for the deployment to complete (the page refreshes automatically). The deployment is complete when your API displays on the Deployed tab.

![](images/700/img22.png)

Copy the URL that appears in the Load Balancer URL section. This is the endpoint clients use to send requests to your proxy API on the gateway.

The URL should look something like this: 
http://devgateway.mobiledemo.mobi:8011/onlineshopapproval

![](images/700/img22.png)

### Test API

To test the  integration, we will use Postman installed during the pre-requisite section. Postman will now call APIPCS for the API and if successful, send the request to OICS for processing

![](images/700/img23.png)

On the New Tab page, enter the following information

 Change the GET to POST
URL : http://devgateway.mobiledemo.mobi:8011/onlineshopapproval

![](images/700/img24.png)

Select Headers tab to add the following headers to the request

-Content-Type : application\json

-icsHeader : Value Passed by Postman Through APIPCS

![](images/700/img55.png)

Click **Send** to test Application

Go to the bottom of the page.You will see same  response as tested previously with OICS url.

![](images/700/img56.png)


```
You have now completed Lab 700 of the AIC Developer Workshop. In the next lab, we will use ABCS to implement an Online Shopping mobile application.

- This Lab is now completed.

