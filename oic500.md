<img class="float-right" src="images/j2c-logo.png" width="200">

# **Lab 500: Create Approval Workflow to process orders**

## **Introduction**

In this Lab we are going to use AIC Process Automation capability to implement a Business Process that will be triggered for suspended orders from online shopping API call.

## **Objectives**
- Create Approval Workflow To Process Orders

## **Required Artifacts**

- The following lab and an Oracle Public Cloud account that will be supplied by your instructor.

---

## **5.1.1** Login to your Oracle Cloud account

### Login to OIC Integration Home Page

>***NOTE:*** the **User Name** and **Password** values will be given to you by your instructor. See _Lab 100 **1.1.1**: Login to your Oracle Cloud Account_ for more information on how to sign into the OIC home page

![](images/200/image086.png)

### Creating An Application
**5.1.1.1** In the Integration Cloud navigation pane, click **Processes** and then **Processes Process Application** 

![](images/500/img01.png)

![](images/500/img01_1.png)

**5.1.1.2** 
- A new page comes up.Click on the **Create** button on top right as shown below

![](images/500/img0117.png)

- Select **Create an Application** 
 
![](images/500/img0117_1.png)

**5.1.1.3**Here you need to provide the Application name as per your choice ,description if you wish to and Click **Create** button as shown.You can use  either use an existing Space or create a new one as per your wish.

![](images/500/img04.png)

### Creating Web Forms

**5.1.1.9** Next we need to create Web Forms.Use the web forms editor to create forms for your human tasks and start form events without scripting rules.

Click on **Forms** tab as shown

![](images/500/img12.png)

**5.1.2.0** A new page comes up.Click on **Create** button as shown below 

![](images/500/img13.png)

**5.1.2.1** Next we need to provide the form name `Notification Approval Web Form` and click **Create** 

![](images/500/img14.png)

**5.1.2.2** The web forms editor opens in a new tab named with the title you entered for the form.

The editor contains a central canvas on which you construct the form by dragging and dropping available controls from the palettes onto the canvas.The Properties pane lets you select settings. The Data pane lists data attributes for the formâ€™s control.

![](images/500/img72.png)

**5.1.2.3** 
- To design a WebForm, you need to drag and drop the activities from Right pallet. For our form we will need **Text Area** and **Number** elements.

![](images/500/img118.png)

- To create Order ID field, Drop **Text Area** to the center.

![](images/500/img118_1.png)

- By clicking on Text Area, change TextArea **Label** (control name that displays to users) to `Order ID` and **Name** (internal name for the controller) to `orderID`. 

![](images/500/img118_2.png)

- Repeat the listed above steps to create: 
Labels with corresponding Names:
`Shipping State` - **shippingState**
`Model` - **model**
`returnReason` - **returnReason**
`Status` - **status**

- After, drag and drop **Number" Activity to create `Unit Price` and `Items Number`:
`Unit Price` - **unitPrice**
`Items Number` - **unitPrice**

![](images/500/img120.png)

**5.1.2.4** All of the fields will appear as you outlined .Reverify all the parameters before saving.

![](images/500/img121.png)

![](images/500/img19_1.png)

Click on Preview button to see how the webform will look in various devices.

![](images/500/img122.png)

![](images/500/img123.png)

### Creating Process Flow

**5.1.2.5** Now that we are done with creating webforms next we need to design the flow.From menu items select **Process** Tab as shown below 

![](images/500/img24.png)


**5.1.2.6** A new page comes up which  shows process flows and its various options avalaible..From here select **Form Approval Pattern** 
![](images/500/img25.png)

**5.1.2.7** Provide the name of the process and select **Create** as shown below

![](images/500/img26.png)

**5.1.2.8** This is is the place where we will design,edit,build our workflow for approval/ rejection process.This is sample flow which comes up as shown below in the diagram

![](images/500/img27_12.png)

**5.1.2.9** For this implementation its simple workflow,user needs to either approve or reject based on input parameter.Edit/Delete the remaining items and finally it should look like as shown below

![](images/500/img27_11_1.png)

![](images/500/img27_11_2.png)

![](images/500/img27_11.png) 


**5.1.3.0** Next, start designing the business process by renaming  and adding  elements from the Elements Palette .From **Process Owner** swimlane double click on the **Submit Request** event as shown below

![](images/500/img28.png)

**5.1.3.1** Click on **Open Properties**

![](images/500/img29.png)

**5.1.3.2** A new canvas opens up.From here navigate to the **Forms** section,click on **Search** icon  and select previously created  Webform  as shown

![](images/500/img35_1.png)

Make sure you have a title to your Form.

![](images/500/img35_3.png)

**5.1.3.3** Now go  back to main flow and   select **Data Association** from **Submit Request** event  

![](images/500/img35_2.png)

**5.1.3.4** Data association refers to the flow of data within a process. We Use the Data Association editor to define input and output for flow elements that need them. Here we don't need to make any changes.The left plane displays the payload or input parameters and right plane displays data objects in an expandable tree. Click **Cancel** to exit from this section

![](images/500/img58.png)

**5.1.3.5** Back to the main page, next click on  the **Approve Request** item and select **Open Properties** 

![](images/500/img37.png)

**5.1.3.56** A new tab opens up.

Navigate to the assignee section and add new approver

It is three step process.Perform required actions as shown

![](images/500/img124.png)

![](images/500/img125.png)

![](images/500/img125_1.png)

![](images/500/img126.png)

**5.1.3.6** Next navigate to the **Forms** section,click on **Search** icon  and select previously created  Webform  as shown. Click **OK** to close the tab.

![](images/500/img37_1.png)

![](images/500/img37_2.PNG)

**5.1.3.7** Now back to the main page and click on   **Open Data Association** 

![](images/500/img37_3.png)

**5.1.3.8** Here the left plane displays the data objects and right pane displays payload or input parameters.Since we dont need to make any change,click **Cancel** to exit from the section.

![](images/500/img49_1.png)

### Save,Publish and Activate Changes

**5.1.3.9** Now that we are done with the developement,click **Save** on top right of the process flow to commit all your work.

![](images/500/img46.png)

**5.1.4.0** Next click on **Publish** button on the top right corner as shown.

![](images/500/img47.png)

**5.1.4.1** A new tab opens up, provide your comments and again click **Publish** button as shown

![](images/500/img48.png)

**5.1.4.2** Next we need to deploy our applications before we can test out. Click **Activate** button as shown

![](images/500/img50.png)

**5.1.4.3** Follow remaining  steps as shown below sequentially to complete your activation.

![](images/500/img51.png)

![](images/500/img52.png)

![](images/500/img53.png)

![](images/500/img54.png)

Congradulation, you deployed the application. 

**5.1.4.4** Now we are goiing to test it. For that we need 
1. An administrator permission - if you are an administrator you are going to be given that permission by default. 
2. To access a WSDL url. 

First, from Integration Cloud home page, you need to click on **Processes** tab.

![](images/500/img55_0.png)

Sfter clicking on  **Process Applications**, you are going to see a window as bellow. Select **Activate**.

![](images/500/img55_1.png)

**5.1.4.5** A new page will open up, where you will see all the deployed applications. Try to find the one you have deployed and click on **Webservices** tab as shown below. 

![](images/500/img56.png)

**5.1.4.2** Here you will see an endpoint url under exposed tab. Select the same and close the browser.

![](images/500/img57.png)

### Assigning Roles

**5.1.4.3** In this section we will assign roles to end users and define their permissions to start an application. To begin, go to your **Home** tab as shown below.

![](images/500/img71_1.png)

Scrol down and select **Tracking** as shown bellow:

![](images/500/img71_2.png)

Select **Administration** as shown bellow:

![](images/500/img71.png)

**5.1.1.4.4** From left sidebar select **Manage Roles** tab  

![](images/500/img67.png)

**5.1.4.5** Next navigate  to the **Process Roles** tab and search for your application 

![](images/500/img68.png)

**5.1.4.6** From the list select Reviewer and add the required user  by clicking **Add Member** button as shown

![](images/500/img69.png)

**5.1.4.7** When a new tab opens up, Search the name that is associated with that Oracle Account, Select and  Click **OK** to add the required user.

![](images/500/img70.png)

After each addition of a user, **Save** the changes. 
Repeat similar set of steps for Process Owner and Viewer.

![](images/500/img70_1.png)

### Test Your Applications

**5.1.4.8** Now we will test our applications using Postman. Open the app and update the endpoint url as shown below. Also select type as **Basic Auth** and method as **Post**

![](images/500/img59.png)

**5.1.4.9** Next click on the **Body** tab and paste the below sample json structure. Once done click **Send** button to test our applications.

{
	"processDefId":"oracleinternalpcs~OnlineShopProcessApproval!1.4~OnlineShopApprovalForm",
	"serviceName":"OnlineShopApprovalForm.service",
	"operation":"submitRequest",
	"action":"Submit",
    "payload" : "{ \"orderID\":\"Form description1\",\"unitPrice\":\"100\",\"shippingState\":\"shipped1\",\"noOfitems\":\"201\",\"status\":\"returned\",\"returnReason\":\"bad-product1\",\"model\":\"x1241\"}"
}
	

![](images/500/img60_1.png)

**5.1.5.0** Scroll down you will see status is **200OK**.This means our test is successful

![](images/500/img61.png)

**5.1.5.1** Now move  back to Process Cloud Services and from there select **My Tasks** as shown below

![](images/500/img62.png)

**5.1.5.2** Here you will list of all applications which needs to be approved.

![](images/500/img63.png)

**5.1.5.2** Select any one of them and in next page you will see complete list of input parameters as passed from postman. Click **Approve** or **Reject** as per your wish.

![](images/500/img127.png)


```
You have now completed Lab 500 of the AIC Developer Workshop. In the next lab, we will use AIC ABCS to invoke Approval Workflow when a suspended order is returned from from Online Shopping API.

- This Lab is now completed.

